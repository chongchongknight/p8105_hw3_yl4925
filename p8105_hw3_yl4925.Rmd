---
title: "p8105_hw3_yl4925"
author: "Yiming Li"
date: "10/12/2021"
output: github_document
---

## Problem 1
```{r}
library(tidyverse)
library(p8105.datasets)
data("instacart")
instacart_row = nrow(instacart)
instacart_column = ncol(instacart)
```


```{r}
# this is structure for instacart 
str(instacart)
```

Instacart is an online grocery service that allows you to shop online from local stores.The size of this dataset is (`r instacart_row`, `r instacart_column`). We find that 4 out of 15 variables are character variable. They are eval_set, product_name, aisle and department. The rest 11 variables are integer variables. They are order_id, product_id, add_to_cart_order, reordered, user_id. order_number, order_dow, order_hour_of_day, days_since_prior_order, aisle_id and department_id. All id variables represent specific  accounts and items.

Reordered variables indicates whether this product has been ordered by this user in the past, with 1 is yes, 0 is no.

Order_number indicates the order sequence of users with n represents this is nth order for user.

Order_dow, order_hour_of_day and days_since_prior_order indicate time of making order and time interval from last order. For example, order_dow is 4 means order is made on Thursday. Order_hour_of_day is 10 means order is made on 10a.m. Days_since_prior_order is 30 means that last order is made 30 days before.

The rest variables indicate products' property.

```{r}
aisle = group_by(instacart, aisle) %>% 
  summarise(nobs = n()) %>% 
  arrange(-nobs)
aisle_row = nrow(aisle)
aisle_most = aisle$aisle[1]
```
There are totally `r aisle_row` aisles, and `r aisle_most` is aisle which the most items ordered from. 

Make a plot that shows the number of items vs aisle with more than 10000 items ordered. 
```{r}
aisle %>% 
  filter(nobs > 10000 ) %>%
  ggplot(aes(x = nobs, y = aisle)) + 
  labs(
    title = "Items in different aisle",
    x = "item count in each aisle",
    y = "aisle name"
  ) + geom_point() 
```

Three most popular items in "baking ingredients", "dog food care", and packaged vegetable fruits".
```{r}
instacart %>% 
  filter(aisle == "baking ingredients") %>% 
  group_by(product_name) %>% 
  summarise(count = n()) %>% 
  arrange(-count) %>% 
  filter(1:n() <= 3)

instacart %>% 
  filter(aisle == "dog food care") %>% 
  group_by(product_name) %>% 
  summarise(count = n()) %>% 
  arrange(-count) %>% 
  filter(1:n() <= 3)

instacart %>% 
  filter(aisle == "packaged vegetables fruits") %>% 
  group_by(product_name) %>% 
  summarise(count = n()) %>% 
  arrange(-count) %>% 
  filter(1:n() <= 3)

```

Mean hour of the day at which Pink Lady Apples and Coffee Ice Cream are ordered on each day of the week
```{r}
instacart %>% 
  filter(product_name == "Pink Lady Apples" | product_name == "Coffee Ice Cream") %>% 
  group_by(product_name, order_dow) %>% 
  summarise(mean = mean(order_hour_of_day)) %>% 
  pivot_wider(
    names_from = order_dow,
    values_from = mean
  ) 
```


## Problem 2
Load data
```{r}
library(p8105.datasets)
data("brfss_smart2010")
```

I do the data cleaning in this chunk and mainly focus on Overall Health topic. And also factor response variable from poor to excellent.
```{r}
brfss_clean = brfss_smart2010 %>% 
  janitor::clean_names() %>% 
  filter(topic == "Overall Health") %>% 
  mutate(response = factor(response, 
                           levels = c("Poor", "Fair", "Good", "Very good", "Excellent"), 
                           ordered = TRUE)) %>% 
  arrange(response)
```



```{r}

```


